# NS scan

## CNAME identify

================================================
   Check Vulnerability - Subdomain Takeover
================================================

```sh
# cnmaes
./dnsx -l subdomains.txt -cname -json | jq -r 'select(.cname != null) | "\(.host) -> \(.cname)"' | sort -u > 7.cnames.txt

# only subdomains ips
./dnsx -l subdomains.txt -a -resp-only | sort -u > 8.subs_ips_only.txt

# subdomain  :  ip
./dnsx -l subdomains.txt -a -resp | sort -u | awk '{print $1 "  " $3}' | sort -u > 9.subs_ips.txt

# ip: sub, sub, sub
./dnsx -l subdomains.txt -a -resp | awk '{print $3, $1}' | awk '{a[$1]=(a[$1] ? a[$1] ", " $2 : $2)} END {for (ip in a) print ip " " a[ip]}' > 10.grouped_ip_subs.txt
